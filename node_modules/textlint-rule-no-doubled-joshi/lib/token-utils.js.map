{"version":3,"file":"token-utils.js","names":["is助詞Token","token","test","pos","is括弧Token","pos_detail_1","create読点Matcher","commaCharacters","is読点Token","includes","surface_form","concatToken","aToken","bToken","concatJoishiTokens","tokens","newTokens","forEach","prevToken","length","push","createKeyFromKey","pos_detail_2","pos_detail_3","restoreToSurfaceFromKey","key","split"],"sources":["../src/token-utils.ts"],"sourcesContent":["// LICENSE : MIT\n\"use strict\";\n\nimport { KuromojiToken } from \"kuromojin\";\n\n// 助詞どうか\nexport const is助詞Token = (token: KuromojiToken) => {\n    // 結合しているtokenは助詞助詞のようになってるため先頭一致で見る\n    return token && /^助詞/.test(token.pos);\n};\n\nexport const is括弧Token = (token: KuromojiToken) => {\n    return token && token.pos === \"記号\" && (token.pos_detail_1 === \"括弧開\" || token.pos_detail_1 === \"括弧閉\");\n};\n\n/**\n * 読点を判定する関数を返す\n * 注意: 名詞や記号ではないトークンは読点として扱えない\n * @param commaCharacters\n */\nexport const create読点Matcher = (commaCharacters: string[]) => {\n    return function is読点Token(token: KuromojiToken) {\n        return (\n            commaCharacters.includes(token.surface_form) &&\n            // 、や, は名詞扱いの場合がある(0.1.2で記号となる)\n            (token.pos === \"名詞\" ||\n                // ，は記号 && 読点となる(surface_formを優先するために pos_detail_1/読点 のチェックを省く)\n                token.pos === \"記号\")\n        );\n    };\n};\n/**\n * aTokenの_extraKeyに結合したkeyを追加する\n * @param {Object} aToken\n * @param {Object} bToken\n * @returns {Object}\n */\nconst concatToken = (aToken: KuromojiToken, bToken: KuromojiToken) => {\n    aToken.surface_form += bToken.surface_form;\n    aToken.pos += bToken.pos;\n    aToken.pos_detail_1 += bToken.surface_form;\n    return aToken;\n};\n/**\n * 助詞+助詞 というように連続しているtokenを結合し直したtokenの配列を返す\n * @param {Array} tokens\n * @returns {Array}\n */\nexport const concatJoishiTokens = (tokens: KuromojiToken[]) => {\n    const newTokens: KuromojiToken[] = [];\n    tokens.forEach((token) => {\n        const prevToken = newTokens[newTokens.length - 1];\n        if (is助詞Token(token) && is助詞Token(prevToken)) {\n            newTokens[newTokens.length - 1] = concatToken(prevToken, token);\n        } else {\n            newTokens.push(token);\n        }\n    });\n    return newTokens;\n};\n// 助詞tokenから品詞細分類1までを元にしたkeyを作る\n// http://www.unixuser.org/~euske/doc/postag/index.html#chasen\n// http://chasen.naist.jp/snapshot/ipadic/ipadic/doc/ipadic-ja.pdf\nexport const createKeyFromKey = (token: KuromojiToken) => {\n    // e.g.) \"は:助詞.係助詞.*.*\"\n    // \"しようとすると\" と には次の違いある\n    // と\t助詞\t格助詞\t一般 *\n    // と\t助詞\t接続助詞\t*\t*\n    return `${token.surface_form}:${token.pos}.${token.pos_detail_1}.${token.pos_detail_2}.${token.pos_detail_3}`;\n};\n// keyからsurfaceを取り出す\nexport const restoreToSurfaceFromKey = (key: string) => {\n    return key.split(\":\")[0];\n};\n"],"mappings":"AAAA;AACA,YAAY;;AAAC;EAAA;AAAA;AAAA;AAIb;AACO,IAAMA,SAAS,GAAIC,KAAoB,IAAK;EAC/C;EACA,OAAOA,KAAK,IAAI,KAAK,CAACC,IAAI,CAACD,KAAK,CAACE,GAAG,CAAC;AACzC,CAAC;AAAC;AAEK,IAAMC,SAAS,GAAIH,KAAoB,IAAK;EAC/C,OAAOA,KAAK,IAAIA,KAAK,CAACE,GAAG,KAAK,IAAI,KAAKF,KAAK,CAACI,YAAY,KAAK,KAAK,IAAIJ,KAAK,CAACI,YAAY,KAAK,KAAK,CAAC;AACxG,CAAC;;AAED;AACA;AACA;AACA;AACA;AAJA;AAKO,IAAMC,eAAe,GAAIC,eAAyB,IAAK;EAC1D,OAAO,SAASC,SAAS,CAACP,KAAoB,EAAE;IAC5C,OACIM,eAAe,CAACE,QAAQ,CAACR,KAAK,CAACS,YAAY,CAAC;IAC5C;IACCT,KAAK,CAACE,GAAG,KAAK,IAAI;IACf;IACAF,KAAK,CAACE,GAAG,KAAK,IAAI,CAAC;EAE/B,CAAC;AACL,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AALA;AAMA,IAAMQ,WAAW,GAAG,CAACC,MAAqB,EAAEC,MAAqB,KAAK;EAClED,MAAM,CAACF,YAAY,IAAIG,MAAM,CAACH,YAAY;EAC1CE,MAAM,CAACT,GAAG,IAAIU,MAAM,CAACV,GAAG;EACxBS,MAAM,CAACP,YAAY,IAAIQ,MAAM,CAACH,YAAY;EAC1C,OAAOE,MAAM;AACjB,CAAC;AACD;AACA;AACA;AACA;AACA;AACO,IAAME,kBAAkB,GAAIC,MAAuB,IAAK;EAC3D,IAAMC,SAA0B,GAAG,EAAE;EACrCD,MAAM,CAACE,OAAO,CAAEhB,KAAK,IAAK;IACtB,IAAMiB,SAAS,GAAGF,SAAS,CAACA,SAAS,CAACG,MAAM,GAAG,CAAC,CAAC;IACjD,IAAInB,SAAS,CAACC,KAAK,CAAC,IAAID,SAAS,CAACkB,SAAS,CAAC,EAAE;MAC1CF,SAAS,CAACA,SAAS,CAACG,MAAM,GAAG,CAAC,CAAC,GAAGR,WAAW,CAACO,SAAS,EAAEjB,KAAK,CAAC;IACnE,CAAC,MAAM;MACHe,SAAS,CAACI,IAAI,CAACnB,KAAK,CAAC;IACzB;EACJ,CAAC,CAAC;EACF,OAAOe,SAAS;AACpB,CAAC;AACD;AACA;AACA;AAAA;AACO,IAAMK,gBAAgB,GAAIpB,KAAoB,IAAK;EACtD;EACA;EACA;EACA;EACA,iBAAUA,KAAK,CAACS,YAAY,cAAIT,KAAK,CAACE,GAAG,cAAIF,KAAK,CAACI,YAAY,cAAIJ,KAAK,CAACqB,YAAY,cAAIrB,KAAK,CAACsB,YAAY;AAC/G,CAAC;AACD;AAAA;AACO,IAAMC,uBAAuB,GAAIC,GAAW,IAAK;EACpD,OAAOA,GAAG,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AAC5B,CAAC;AAAC"}